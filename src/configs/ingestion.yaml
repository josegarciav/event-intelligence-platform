# Configuration for Ingestion Pipelines
# This file defines which sources are enabled, their API credentials,
# scheduling, and source-specific settings.

sources:
  
  
  # =========================================================================
  # RA.CO SCRAPER - Web scraping-based ingestion
  # =========================================================================
  ra_co_scraper:
    enabled: true
    type: "scraper"
    scraper_config: "scrapping/configs/sources/ra_co.json"

    # HTTP Settings
    request_timeout: 30
    max_retries: 3
    batch_size: 50
    rate_limit_per_second: 0.5

    # Scheduling
    schedule:
      type: "interval"
      interval_hours: 12
      enabled: true

    # Enrichment options
    enrichment:
      geocoding: true

    # Validation rules
    validation:
      future_events_only: true
      days_ahead: 60

# =========================================================================
# GLOBAL SETTINGS
# =========================================================================

global:
  # Storage settings
  storage:
    type: "postgresql"
    url: "${DATABASE_URL}"
    pool_size: 10
    max_overflow: 20
  
  # Logging
  logging:
    level: "INFO"
    format: "json"  # or "text"
    file: "logs/ingestion.log"
  
  # Data quality
  quality_thresholds:
    minimum_quality_score: 0.3      # Skip events below this quality
    timezone_confidence: 0.7        # Confidence threshold for timezone inference
  
  # Enrichment services (optional)
  enrichment_services:
    geocoding:
      provider: "google"            # or "nominatim", "mapbox"
      api_key: "${GEOCODING_API_KEY}"
      cache_ttl_hours: 720          # Cache geocoding results for 30 days
    
    image_validation:
      timeout: 5                    # Seconds to wait for image response
      check_accessibility: true
  
  # Monitoring & alerts
  monitoring:
    sentry_enabled: false
    sentry_dsn: "${SENTRY_DSN}"
    
    slack_enabled: false
    slack_webhook: "${SLACK_WEBHOOK}"
    
    alert_on:
      - "pipeline_failure"
      - "low_quality_score"
      - "api_error_rate_high"
